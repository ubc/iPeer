import{d as R,Z as se,A as ne,o,c as u,a as s,t as F,C as le,u as a,D as ie,f as w,z as W,j as S,y as X,$ as z,v as C,q as h,R as O,F as L,e as $,L as Ae,O as oe,r as J,k as D,p as T,w as ue,g as q}from"./main.js";import{_ as M,a as re}from"./EvaluationForm.vue_vue_type_script_setup_true_lang.js";import{_ as ee}from"./UserCard.vue_vue_type_script_setup_true_lang.js";import"./autosize.esm.js";import{e as de}from"./rules.js";import{_ as me}from"./CustomTextField.vue_vue_type_script_setup_true_lang.js";const ce={class:"form-range form-range-inline flex flex-col"},pe={class:"form-range-label text-slate-500"},ve=s("span",{class:"tick"},null,-1),ge=["min","step","max","name","value","disabled"],he={key:0,class:"flex justify-between items-center"},_e={key:0,class:"min text-sm text-slate-500 font-normal"},be={key:1,class:"max text-sm text-slate-500 font-normal"},Be=R({__name:"CustomRangeField",props:{label:null,name:null,value:null,response:null,points:null,rules:null,disabled:{type:Boolean,default:!1},placeholder:{default:""},min:{default:0},step:{default:1},max:{default:100},text:{default:()=>["min","max"]},remaining:null,point_per_member:null},emits:["update:input"],setup(i,{emit:E}){const t=i,{name:n,value:l}=se(t),{value:r,errorMessage:_,handleBlur:v,handleChange:e,meta:A}=ne(n,t.rules,{initialValue:t.value,validateOnValueUpdate:!0}),Q={blur:e,change:e,input:x=>e(x,!!_.value)};return(x,d)=>(o(),u("div",{class:W(["block block-slider",{"has-error":!!a(_),success:a(A).valid}])},[s("label",ce,[s("span",pe,F(t.label),1),ve,s("input",le({class:"form-range-input",type:"range",min:t.min,step:t.step,max:t.max,name:a(n),value:a(r),disabled:i.disabled},ie(Q,!0),{onInput:d[0]||(d[0]=p=>x.$emit("update:input",p)),onBlur:d[1]||(d[1]=(...p)=>a(v)&&a(v)(...p))}),null,16,ge)]),t.text?(o(),u("div",he,[t.text[0]?(o(),u("div",_e,F(t.text[0]),1)):w("",!0),t.text[1]?(o(),u("div",be,F(t.text[1]),1)):w("",!0)])):w("",!0)],2))}}),xe="data:image/gif;base64,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",Ie={class:"flex justify-between items-center"},Qe={class:""},fe=["src"],te=R({__name:"AutoSpinner",props:{text:null,autosave:{type:Boolean}},setup(i){const E=i;return(t,n)=>{var l;return o(),u("span",Ie,[s("span",Qe,F(E.text),1),s("span",{class:W(`text-xs mx-8 text-${(l=E.autosave)==null?void 0:l.type}`)},[E.autosave?(o(),u("img",{key:0,class:"w-4 h-4",src:a(xe)},null,8,fe)):w("",!0)],2)])}}}),Ce={class:"datatable"},we={key:0,class:"question"},ye={key:1,class:"description text-sm mx-4 mb-2"},ke={class:"standardtable"},De=s("th",{style:{width:"20%"}},[s("div",{class:"text-center leading-4"},[s("div",{class:"font-normal"},"Peer"),s("div",{class:"text-sm font-thin"})])],-1),Ee={style:{width:"80%"}},Se={class:"text-center leading-4"},Fe={class:"font-normal"},Me=s("div",{class:"text-sm font-thin"},null,-1),Ge={style:{width:"20%"}},Ue={style:{width:"80%"}},Re=["name","value"],He={key:0,class:"text-xs text-red-400"},Ye=R({__name:"PeerSimpleRangeQuestion",props:{members:null,initialState:null,remaining:null,point_per_member:null,name:null,label:null,question:null,description:null,placeholder:null,disabled:{type:Boolean},autosave:{type:Boolean}},setup(i,{emit:E}){var x;const t=i,n=S(!1),l=X(t,"initialState"),r=S((x=t.remaining)!=null?x:t.members.length*t.point_per_member),_=S([]),v=S(0),e=S([]);function A(d){const{target:p,key:b,value:m}=d,c=_.value[b];v.value+=parseInt(m)-c,v.value<=0?e.value=C.exports.map(e.value,()=>r.value/e.value.length):(_.value[b]=parseInt(m),e.value=C.exports.map(_.value,g=>Math.round(r.value*g/v.value))),Q(),l.value.data.points=e.value}z(()=>{var p,b,m;const d=(b=(p=l.value)==null?void 0:p.data)==null?void 0:b.points;if(d!=null&&d.length)e.value=[...d],_.value=C.exports.map(d,(c,g)=>{const I=parseInt(c)/r.value,B=100*I;return v.value+=B,B});else{const c=Math.round(r.value/t.members.length);_.value=C.exports.map(t.members,()=>c),v.value=c*((m=t.members)==null?void 0:m.length),e.value=C.exports.map(t.members,()=>r.value/t.members.length)}});function Q(){const d=C.exports.reduce(e.value,(c,g)=>c+=g,0),p=r.value-d,b=p>0?Math.min(...e.value):Math.max(...e.value),m=C.exports.findIndex(e.value,c=>c===b);e.value[m]+=p}return(d,p)=>(o(),u("div",Ce,[t.question?(o(),u("div",we,[h(te,{text:t.question,autosave:t.autosave},null,8,["text","autosave"])])):w("",!0),t.description?(o(),u("div",ye,F(t.description),1)):w("",!0),s("table",ke,[s("thead",null,[s("tr",null,[De,s("th",Ee,[s("div",Se,[s("div",Fe,[O("Relative C"),s("span",{onClick:p[0]||(p[0]=b=>n.value=!n.value)},"o"),O("ntribution")]),Me])])])]),s("tbody",null,[(o(!0),u(L,null,$(t.members,(b,m)=>{var c,g,f,I,B,y,k,G,U,H,Y,N,K,P,V,Z,j;return o(),u("tr",{key:b.id},[s("td",Ge,[h(ee,{member:b},null,8,["member"])]),s("td",Ue,[s("input",{type:"hidden",name:`${i.name}[${m}]`,value:((c=a(l))==null?void 0:c.data)&&((g=a(l))==null?void 0:g.data[i.name])?(f=a(l))==null?void 0:f.data[i.name][m]:""},null,8,Re),h(a(Be),{max:t.remaining,text:["Less","More"],label:"A fair amount",name:`percent[${m}]`,value:(B=(I=a(l))==null?void 0:I.data)==null?void 0:B.points[m],response:(k=(y=a(l))==null?void 0:y.data)==null?void 0:k.points,points:((G=a(l))==null?void 0:G.data)&&((H=(U=a(l))==null?void 0:U.data)==null?void 0:H.points)?(N=(Y=a(l))==null?void 0:Y.data)==null?void 0:N.points[m]:"",placeholder:i.placeholder,disabled:t.disabled,remaining:t.remaining,point_per_member:t.point_per_member,"onUpdate:input":ae=>A({target:i.name,key:m,value:ae.target.value})},null,8,["max","name","value","response","points","placeholder","disabled","remaining","point_per_member","onUpdate:input"]),n.value?(o(),u("div",He,F(((K=a(l))==null?void 0:K.data)&&((V=(P=a(l))==null?void 0:P.data)==null?void 0:V.points)?(j=(Z=a(l))==null?void 0:Z.data)==null?void 0:j.points[m]:""),1)):w("",!0)])])}),128))])])]))}}),qe={class:"datatable",id:"PeerSimpleRangeQuestion"},Le={key:0,class:"question"},$e={key:1,class:"description text-sm mx-4 mb-2"},Ne={class:"standardtable"},Ke=s("thead",null,[s("tr",null,[s("th",{style:{width:"20%"}},[s("div",{class:"text-center leading-4"},[s("div",{class:"font-normal"},"Peer"),s("div",{class:"text-sm font-thin"})])]),s("th",{style:{width:"80%"}},[s("div",{class:"text-center leading-4"},[s("div",{class:"font-normal"},"Comments"),s("div",{class:"text-sm font-thin"})])])])],-1),Pe={style:{width:"20%"}},Ve={style:{width:"80%"}},Ze=R({__name:"PeerSimpleCommentQuestion",props:{members:null,initialState:null,question:null,name:null,label:null,description:null,placeholder:null,disabled:{type:Boolean},autosave:{type:Boolean}},setup(i,{emit:E}){const t=i;return(n,l)=>(o(),u("div",qe,[t.question?(o(),u("div",Le,[h(te,{text:t.question,autosave:t.autosave},null,8,["text","autosave"])])):w("",!0),t.description?(o(),u("div",$e,F(t.description),1)):w("",!0),s("table",Ne,[Ke,s("tbody",null,[(o(!0),u(L,null,$(t.members,(r,_)=>(o(),u("tr",{key:r.id},[s("td",Pe,[h(ee,{member:r},null,8,["member"])]),s("td",Ve,[h(me,{label:i.label,name:`${i.name}[${_}]`,rules:a(de),disabled:t.disabled},null,8,["label","name","rules","disabled"])])]))),128))])])]))}}),ze=R({__name:"SimpleEvaluation",props:{members:null,currentUser:null,evaluation:null,disabled:{type:Boolean}},emits:["fetch:evaluation"],setup(i,{emit:E}){const t=i;Ae(),oe(),S();const n=X(t,"evaluation"),l=J({event_id:D(()=>{var e;return(e=n.value)==null?void 0:e.id}),group_id:D(()=>{var e,A;return(A=(e=n.value)==null?void 0:e.group)==null?void 0:A.id}),course_id:D(()=>{var e,A;return(A=(e=n.value)==null?void 0:e.course)==null?void 0:A.id}),group_event_id:D(()=>{var e;return(e=n.value)==null?void 0:e.group_event_id}),rubric_id:D(()=>{var e;return(e=n.value)==null?void 0:e.rubric_id}),user_id:D(()=>{var e;return(e=t.currentUser)==null?void 0:e.id}),evaluatee_count:D(()=>{var e,A;return(A=(e=n.value)==null?void 0:e.members)==null?void 0:A.length}),member_ids:D(()=>{var e;return C.exports.map((e=n.value)==null?void 0:e.members,A=>A.id)})}),r=S({});function _(){var e;return{id:"",submitter_id:(e=t.currentUser)==null?void 0:e.id,submitted:null,date_submitted:"",data:{points:[],comments:[]}}}const v=J({points:{title:"1. Please rate each peer's relative contribution.",description:""},comments:{title:"2. Please provide overall comments about each peer.",description:""}});return z(()=>{var A,Q,x;const e=_();((A=n.value)==null?void 0:A.response)&&!C.exports.isEmpty((Q=n.value)==null?void 0:Q.response)?r.value=Object.assign(e,a((x=n.value)==null?void 0:x.response)):r.value=e}),(e,A)=>(o(),T(re,{onSubmit:e.onSubmit,"initial-state":r.value,evaluation:a(n),"onSet:message":A[0]||(A[0]=Q=>e.$emit("set:message",e.message))},{default:ue(({onSave:Q,errors:x,values:d,isSubmitting:p,evaluationRef:b,message:m,autosave:c})=>[q(e.$slots,"header",{},()=>{var g,f,I,B,y,k,G,U;return[h(a(M),{type:"hidden",name:"event_id",value:(g=a(n))==null?void 0:g.id},null,8,["value"]),h(a(M),{type:"hidden",name:"group_id",value:(I=(f=a(n))==null?void 0:f.group)==null?void 0:I.id},null,8,["value"]),h(a(M),{type:"hidden",name:"course_id",value:(y=(B=a(n))==null?void 0:B.course)==null?void 0:y.id},null,8,["value"]),h(a(M),{type:"hidden",name:"data[Evaluation][evaluator_id]",value:(k=i.currentUser)==null?void 0:k.id},null,8,["value"]),h(a(M),{type:"hidden",name:"evaluateeCount",value:(U=(G=a(n))==null?void 0:G.members)==null?void 0:U.length},null,8,["value"]),(o(!0),u(L,null,$(l==null?void 0:l.member_ids,(H,Y)=>(o(),T(a(M),{type:"hidden",name:"memberIDs[]",key:Y,value:H},null,8,["value"]))),128))]}),q(e.$slots,"main",{},()=>{var g,f,I,B,y,k;return[h(Ye,{members:(g=a(n))==null?void 0:g.members,remaining:(I=(f=a(n))==null?void 0:f.simple)==null?void 0:I.remaining,point_per_member:(y=(B=a(n))==null?void 0:B.simple)==null?void 0:y.point_per_member,initialState:r.value,name:"points",question:v.points.title,description:v.points.description,disabled:i.disabled,autosave:c},null,8,["members","remaining","point_per_member","initialState","question","description","disabled","autosave"]),h(Ze,{members:(k=a(n))==null?void 0:k.members,initialState:r.value,name:"comments",question:v.comments.title,description:v.comments.description,disabled:i.disabled,autosave:c},null,8,["members","initialState","question","description","disabled","autosave"])]}),q(e.$slots,"footer"),q(e.$slots,"cta",{onSave:Q,isSubmitting:p,values:d})]),_:3},8,["onSubmit","initial-state","evaluation"]))}});export{ze as default};
//# sourceMappingURL=SimpleEvaluation.js.map
