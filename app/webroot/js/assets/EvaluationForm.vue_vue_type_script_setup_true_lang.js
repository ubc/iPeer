import{d as T,y as V,A as B,o as $,c as D,u as l,O as C,P as I,j as f,m as h,G as b,v as P,g as K,Q as L}from"./main.js";const j=["name","value","checked"],A=T({__name:"CustomHiddenField",props:{name:null,value:null,modelValue:null},setup(v){const i=v,o=V(i,"name"),{checked:d,handleChange:_}=B(o,void 0,{type:"hidden",checkedValue:i.value});return(g,y)=>($(),D("input",{type:"hidden",name:l(o),value:i.value,checked:l(d)},null,8,j))}}),E=T({__name:"EvaluationForm",props:{evaluation:null,initialState:null},emits:["on:submit","on:save","set:message"],setup(v,{emit:i}){var S;const o=v,d=C(),{values:_,errors:g,meta:y,handleSubmit:F,isSubmitting:O}=I({initialValues:(S=o.initialState)==null?void 0:S.data}),c=f(),n=f(null),p=f(!1);function R({errors:t}){var s;const u=Object.keys(t)[0],a=document.getElementById(u);(s=a==null?void 0:a.focus)==null||s.call(a),a==null||a.scrollIntoView({behavior:"smooth"})}const w=F(async()=>{var a,s,r;n.value=null;const t=new FormData(c.value);t.append("_method","POST");const u=new URLSearchParams;for(const e of t)u.append(e[0],e[1]);try{const e=await h.post("/evaluations/makeEvaluation/",`${(a=o.evaluation)==null?void 0:a.id}/${(r=(s=o.evaluation)==null?void 0:s.group)==null?void 0:r.id}`,u);e.status===200&&e.statusText==="OK"?(n.value=e.data,await d.push({name:"student.events"})):n.value={message:e.statusText,status:e.status,type:e.statusText}}catch(e){n.value={message:e.response.message,type:"error"}}},R);async function U(){var t,u,a;n.value=null;try{const s=new FormData(c.value);s.append("_method","PUT");const r=new URLSearchParams;for(const m of s)r.append(m[0],m[1]);const e=await h.post("/evaluations/makeEvaluation/",`${(t=o.evaluation)==null?void 0:t.id}/${(a=(u=o.evaluation)==null?void 0:u.group)==null?void 0:a.id}`,r);e.status===200&&e.statusText==="OK"?n.value=e.data:n.value={text:e.statusText,status:e.status,type:e.statusText}}catch{n.value={text:"something went wrong...",status:500,type:"error"}}}return b(()=>P.exports.cloneDeep(o.initialState),P.exports.debounce(async(t,u)=>{var a,s,r;p.value=!0;try{const e=new FormData(c.value);e.append("_method","PUT");const m=new URLSearchParams;for(const k of e)m.append(k[0],k[1]);const x=await h.post("/evaluations/makeEvaluation/",`${(a=o.evaluation)==null?void 0:a.id}/${(r=(s=o.evaluation)==null?void 0:s.group)==null?void 0:r.id}`,m);x.status===200&&x.statusText==="OK"&&(p.value=!1)}catch(e){n.value={text:e.response.message,status:e.status,type:"error"}}finally{p.value=!1}},5e3),{deep:!0}),b(n,t=>{i("set:message",t)},{deep:!0}),(t,u)=>($(),D("form",{novalidate:"",onSubmit:u[0]||(u[0]=L((...a)=>l(w)&&l(w)(...a),["prevent"])),id:"evaluation_form",class:"evaluation-form",ref_key:"evaluation_form",ref:c},[K(t.$slots,"default",{values:l(_),errors:l(g),formMeta:l(y),isSubmitting:l(O),message:n.value,autosave:p.value,onSave:U,evaluationRef:c.value})],544))}});export{A as _,E as a};
//# sourceMappingURL=EvaluationForm.vue_vue_type_script_setup_true_lang.js.map
