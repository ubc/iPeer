import{V as M,u as R,W as z,X as D,R as V,x as F,d as G,D as S,r as N,i as o,E as T,C as d,k as u,c as j,j as c,w as A,F as K,f as O,Q,z as W,o as l}from"./main.386b2761.js";import{_ as X}from"./Loader.vue_vue_type_script_setup_true_lang.633438c3.js";import{_ as Y}from"./PageHeading.vue_vue_type_script_setup_true_lang.bf8bebc0.js";import{_ as q,I as H}from"./ViewHeading.vue_vue_type_script_setup_true_lang.1793555d.js";import{_ as $}from"./NotAvailable.vue_vue_type_script_setup_true_lang.a02c381f.js";const J=M("reviews",{state:()=>({loading:!1,error:null,reviews:null,members:null}),actions:{async fetchReviews(r,n){var i,a,t;R(),this.loading=!0,this.error=null,this.reviews=null,this.members=null;try{const e=await z.get("/evaluations/studentViewEvaluationResult",`${r}/${n}`);switch(e.status){case 200:e.statusText==="OK"?(this.reviews=await((i=e==null?void 0:e.data)==null?void 0:i.data),this.members=await((t=(a=e==null?void 0:e.data)==null?void 0:a.data)==null?void 0:t.members)):this.error={message:e.data.message,status:e.status,type:"error"};break;case 202:this.error=e.data;break;default:break}}catch(e){e.response.status===500?this.error={status:e.response.status,text:e.response.data.message,code:e.code,message:e.message,type:"error"}:e.response.status===404?this.error={status:e.status,message:e.message,type:"error"}:e.response.status===204&&(this.error={status:e.response.status,text:e.response.data.message,code:e.code,message:e.message,type:"error"})}finally{await D(1e3),this.loading=!1}}},getters:{hasError(r){return r.error!==null},getGroupMembers(r){var n;if(((n=r.members)==null?void 0:n.length)>0){const a=V().getCurrentUser;let t=[...r.members];const e=F.exports.findIndex(t,{id:a==null?void 0:a.id});if(e!==-1){const m=t.splice(e,1);return[...t,{...m[0],first_name:"Yourself",last_name:""}]}else return r.members}else return r.members}}}),ae=G({__name:"SubmissionIndex",setup(r,{emit:n}){const i=Q();R();const a=V(),t=J(),e=S(i.params.event_id),m=S(i.params.group_id),s=N({loading:o(()=>t.loading),error:o(()=>t.error),hasError:o(()=>t.hasError),reviews:o(()=>t.reviews),members:o(()=>t.getGroupMembers)}),I=o(()=>a.getCurrentUser),U=o(()=>i.name==="submission.view");return T(async()=>await t.fetchReviews(e.value,m.value)),(L,P)=>{var p,v,w,f;const B=W("router-view");return s.loading?(l(),d(X,{key:0})):!s.loading&&s.hasError&&!s.reviews?(l(),d(u($),{key:1,data:s.error},null,8,["data"])):!s.loading&&!s.hasError&&s.reviews?(l(),j(K,{key:2},[c(Y,{title:(v=(p=s.reviews)==null?void 0:p.event)==null?void 0:v.title,settings:{title:`View ${(f=(w=s.reviews)==null?void 0:w.event)==null?void 0:f.title}`}},{default:A(()=>{var g,_,h,b,y,k,x,E,C;return[c(q,{"due-date":(_=(g=s.reviews)==null?void 0:g.event)==null?void 0:_.due_date,"submitted-date":(b=(h=s.reviews)==null?void 0:h.simple)==null?void 0:b.date_submitted,"is-result-released":(k=(y=s.reviews)==null?void 0:y.event)==null?void 0:k.is_result_released,penalties:(x=s.reviews)==null?void 0:x.penalty,group:(E=s.reviews)==null?void 0:E.group,course:(C=s.reviews)==null?void 0:C.course,icon:{src:u(H),size:"6rem"}},null,8,["due-date","submitted-date","is-result-released","penalties","group","course","icon"])]}),_:1},8,["title","settings"]),c(B,{class:"tab-pane fade show active","current-user":u(I),members:s.members,reviews:s.reviews,"is-disabled":u(U)},null,8,["current-user","members","reviews","is-disabled"])],64)):!s.loading&&s.hasError&&!s.reviews?(l(),d(u($),{key:3,status:"custom",data:s.error},null,8,["data"])):O("",!0)}}});export{ae as default};
