import{d as T,o as s,c as d,b as i,t as w,f as U,F as R,e as E,n as Z,C as M,j as f,k as r,x,Q as A,D as j,r as W,S as ee,A as K,i as B,a2 as te,w as ie,g as Q,a4 as ae,a5 as le}from"./main.386b2761.js";import"./autosize.esm.7505a07e.js";import{_ as S,a as re}from"./EvaluationForm.vue_vue_type_script_setup_true_lang.2babf397.js";import{h as ne,g as X}from"./rules.dc1b156b.js";import{_ as se}from"./CustomRadioField.vue_vue_type_script_setup_true_lang.fe611a6d.js";import{_ as F}from"./UserCard.vue_vue_type_script_setup_true_lang.c748ae7e.js";import{_ as Y}from"./CustomTextField.vue_vue_type_script_setup_true_lang.4805027c.js";import"./evaluation.22a24287.js";const ue={class:"standardtable leftalignedtable"},de={style:{width:"20%"}},oe={class:"text-center leading-4"},ce={class:"text-sm font-normal leading-4 mb-1"},me={key:0,class:"text-sm font-thin"},_e={class:"text-center space-x-1"},ve={class:"text-base text-slate-900 font-normal"},be={class:"text-sm text-slate-600 font-thin leading-3"},fe=T({__name:"PeerRubricLikertQuestion",props:{members:null,initialState:null,rubric_criteria:null,rubrics_lom:null,disabled:{type:Boolean}},emits:["update:initialState"],setup(c,{emit:G}){const a=c;function b(o,n,m){const u=x.exports.find(a.initialState.data,{evaluatee:n});return u?x.exports.filter(u==null?void 0:u.details,t=>{if(t.criteria_number===m)return t})[0]:""}function l(o){if(!a.disabled){const n=document.forms[0],m=`selected_lom_${o.key}_${o.target}`;n.querySelector(`input[name=${m}]`).setAttribute("value",o.value)}}return(o,n)=>{var m,u,e;return s(),d("table",ue,[i("thead",null,[i("tr",null,[i("th",de,[i("div",oe,[i("div",ce,w((m=a.rubric_criteria)==null?void 0:m.criteria),1),parseInt((u=a.rubric_criteria)==null?void 0:u.show_marks)?(s(),d("div",me,"("+w((e=a.rubric_criteria)==null?void 0:e.multiplier)+" marks)",1)):U("",!0)])]),(s(!0),d(R,null,E(a.rubrics_lom,(t,_)=>{var v,p;return s(),d("th",{style:Z("width: "+80/((v=a.rubrics_lom)==null?void 0:v.length)+"%"),key:t.id},[i("div",_e,[i("div",ve,w(t.lom_comment),1),i("div",be,w((p=a.rubric_criteria)==null?void 0:p.rubrics_criteria_comment[_].criteria_comment),1)])],4)}),128))])]),i("tbody",null,[(s(!0),d(R,null,E(a.members,(t,_)=>{var v,p,g,h;return s(),d(R,{key:t.id},[c.disabled?U("",!0):(s(),M(S,{key:0,name:`selected_lom_${t.id}_${(v=c.rubric_criteria)==null?void 0:v.id}`,value:(h=(g=b("criteria_num",t.id,(p=c.rubric_criteria)==null?void 0:p.criteria_num))==null?void 0:g.selected_lom)!=null?h:""},null,8,["name","value"])),i("tr",null,[i("td",null,[f(F,{member:t},null,8,["member"])]),(s(!0),d(R,null,E(a.rubrics_lom,(L,N)=>{var C,I,q,D;return s(),d("td",{key:L.id},[f(se,{ref_for:!0,ref:"selected_lom",member_id:t.id,criteria_num:(C=a.rubric_criteria)==null?void 0:C.criteria_num,name:`${t.id}criteria_points_${(I=c.rubric_criteria)==null?void 0:I.id}`,value:L.lom_num,rules:r(ne),checked:(D=b("criteria_num",t.id,(q=c.rubric_criteria)==null?void 0:q.criteria_num))==null?void 0:D.selected_lom,disabled:a.disabled,onClick:$=>{var y;return l({target:(y=c.rubric_criteria)==null?void 0:y.id,key:t.id,value:$.target.value})},onInput:$=>{var y;return o.$emit("update:initialState",{member_id:t.id,criteria_num:(y=c.rubric_criteria)==null?void 0:y.criteria_num,event:{key:"selected_lom",value:$.target.value}})}},null,8,["member_id","criteria_num","name","value","rules","checked","disabled","onClick","onInput"])])}),128))])],64)}),128))])])}}}),pe={class:"standardtable leftalignedtable"},he=i("thead",null,[i("tr",null,[i("th",{style:{width:"20%"}},[i("div",{class:"flex flex-col text-center"},[i("div",{class:"leading-4 flex-1 font-medium"},"Peer"),i("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),i("th",{style:{width:"80%"}},[i("div",{class:"flex flex-col text-center"},[i("div",{class:"flex-1 font-medium"},"Comments"),i("small",{class:"flex-1 text-sm font-normal"})])])])],-1),xe={style:{width:"20%"}},ye={style:{width:"80%"}},ge={class:"flex flex-col"},$e=["innerHTML"],ke=T({__name:"PeerRubricCommentQuestion",props:{members:null,initialState:null,rubric_criteria_idx:null,rubric_criteria:null,disabled:{type:Boolean}},emits:["update:initialState"],setup(c,{emit:G}){const a=c;A();function b(l,o,n){const m=x.exports.find(a.initialState.data,{evaluatee:o});return m?x.exports.filter(m==null?void 0:m.details,e=>{if(e.criteria_number===n)return e})[0]:""}return(l,o)=>(s(),d("table",pe,[he,i("tbody",null,[(s(!0),d(R,null,E(a.members,(n,m)=>{var u,e,t;return s(),d("tr",{key:n.id},[i("td",xe,[f(F,{member:n},null,8,["member"])]),i("td",ye,[i("div",ge,[a.disabled?(s(),d("div",{key:0,class:"quotes text-sm text-slate-700 font-light tracking-wider",innerHTML:b("criteria_comment",n.id,(u=c.rubric_criteria)==null?void 0:u.criteria_num).criteria_comment},null,8,$e)):(s(),M(Y,{key:1,id:`${n.id}comments[${(e=c.rubric_criteria)==null?void 0:e.id}]`,name:`${n.id}comments[${a.rubric_criteria_idx}]`,value:b("criteria_comment",n.id,(t=c.rubric_criteria)==null?void 0:t.criteria_num).criteria_comment,rules:r(X),disabled:a.disabled,onInput:_=>{var v;return l.$emit("update:initialState",{member_id:n.id,criteria_num:(v=c.rubric_criteria)==null?void 0:v.criteria_num,event:{key:"criteria_comment",value:_.target.value}})}},null,8,["id","name","value","rules","disabled","onInput"]))])])])}),128))])]))}}),Se={class:"datatable"},we={key:0,class:"question text-base text-slate-900 tracking-wide"},Ce={key:1,class:"description text-sm text-slate-700 ml-5 mb-2 tracking-wider"},Ie={class:"standardtable leftalignedtable"},qe=i("thead",null,[i("tr",null,[i("th",{style:{width:"20%"}},[i("div",{class:"flex flex-col text-center"},[i("div",{class:"leading-4 flex-1 font-medium"},"Peer"),i("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),i("th",{style:{width:"80%"}},[i("div",{class:"flex flex-col text-center"},[i("div",{class:"flex-1 font-medium"},"General Comments"),i("small",{class:"flex-1 text-sm font-normal"})])])])],-1),De=["innerHTML"],Be=T({__name:"PeerRubricGeneralCommentQuestion",props:{index:null,members:null,initialState:null,disabled:{type:Boolean}},emits:["update:initialState"],setup(c,{emit:G}){const a=c,b=A();j(b.name==="submission.view");const l=W({question:{title:"Please provide overall comments about each peer.",description:""}});function o(n,m){const u=a.initialState;if(u){const e=x.exports.find(u==null?void 0:u.data,{evaluatee:m});if(e)return e[n]}}return(n,m)=>{var u,e;return s(),d("div",Se,[(u=l==null?void 0:l.question)!=null&&u.title?(s(),d("div",we,w(a.index)+". "+w(l.question.title),1)):U("",!0),(e=l==null?void 0:l.question)!=null&&e.description?(s(),d("div",Ce,w(l.question.description),1)):U("",!0),i("table",Ie,[qe,i("tbody",null,[(s(!0),d(R,null,E(a.members,(t,_)=>(s(),d("tr",{key:t.id},[i("td",null,[f(F,{member:t},null,8,["member"])]),i("td",null,[a.disabled?(s(),d("div",{key:0,class:"quotes text-sm text-slate-700 font-light tracking-wider",innerHTML:o("comment",t.id)},null,8,De)):(s(),M(Y,{key:1,name:`${t.id}gen_comment`,value:o("comment",t.id),rules:r(X),disabled:a.disabled,onInput:v=>n.$emit("update:initialState",{member_id:t.id,criteria_num:"",event:{key:"comment",value:v.target.value}})},null,8,["name","value","rules","disabled","onInput"]))])]))),128))])])])}}}),Re={key:0,class:"question"},Ee=i("div",{class:"description text-sm text-slate-700 mx-4 mb-2"},null,-1),Ne=T({__name:"RubricEvaluation",props:{members:null,currentUser:null,evaluation:null,isDisabled:{type:Boolean}},emits:["fetch:evaluation"],setup(c,{emit:G}){const a=c;A(),ee(),j(null);const b=K(a,"members"),l=K(a,"evaluation");let o=W({event_id:B(()=>{var e;return(e=l.value)==null?void 0:e.id}),group_id:B(()=>{var e,t;return(t=(e=l.value)==null?void 0:e.group)==null?void 0:t.id}),course_id:B(()=>{var e,t;return(t=(e=l.value)==null?void 0:e.course)==null?void 0:t.id}),group_event_id:B(()=>{var e;return(e=l.value)==null?void 0:e.group_event_id}),rubric_id:B(()=>{var e;return(e=l.value)==null?void 0:e.rubric_id}),user_id:B(()=>{var e;return(e=a.currentUser)==null?void 0:e.id}),evaluatee_count:B(()=>{var e;return(e=b.value)==null?void 0:e.length}),member_ids:B(()=>x.exports.map(b.value,e=>e.id))});const n=j({});function m(){var e;return{id:"",submitter_id:(e=a.currentUser)==null?void 0:e.id,submitted:null,date_submitted:"",data:x.exports.map(b.value,t=>{var _,v,p,g;return{evaluator:(_=a.currentUser)==null?void 0:_.id,evaluatee:t==null?void 0:t.id,comment:"",score:"",details:x.exports.map((g=(p=(v=l.value)==null?void 0:v.rubric)==null?void 0:p.data)==null?void 0:g.rubrics_criteria,h=>({criteria_number:h==null?void 0:h.criteria_num,criteria_comment:"",selected_lom:""}))}})}}function u(e){var _,v,p,g;const t=x.exports.isEmpty(n.value)?{}:(_=n.value)==null?void 0:_.data;if(t){const h=x.exports.find(t,{evaluatee:e==null?void 0:e.member_id});if(h)if(((v=e==null?void 0:e.event)==null?void 0:v.key)==="comment")h.comment=(p=e==null?void 0:e.event)==null?void 0:p.value;else{const L=x.exports.find(h==null?void 0:h.details,{criteria_number:e.criteria_num});L&&(L[e.event.key]=(g=e.event)==null?void 0:g.value)}}}return te(()=>{var t,_;const e=m();((t=l.value)==null?void 0:t.response)&&!x.exports.isEmpty(l.value.response)?n.value=Object.assign(e,r((_=l.value)==null?void 0:_.response)):n.value=e}),(e,t)=>(s(),M(re,{onSubmit:e.onSubmit,"initial-state":n.value,evaluation:r(l),"onSet:message":t[0]||(t[0]=_=>e.$emit("set:message",e.message))},{default:ie(({onSave:_,errors:v,values:p,isSubmitting:g,evaluationRef:h,message:L,autosave:N})=>[Q(e.$slots,"header",{},()=>{var C,I,q,D,$,y,P,k;return[f(r(S),{type:"hidden",name:"event_id",value:(C=r(o))==null?void 0:C.event_id},null,8,["value"]),f(r(S),{type:"hidden",name:"group_id",value:(I=r(o))==null?void 0:I.group_id},null,8,["value"]),f(r(S),{type:"hidden",name:"group_event_id",value:(q=r(o))==null?void 0:q.group_event_id},null,8,["value"]),f(r(S),{type:"hidden",name:"course_id",value:(D=r(o))==null?void 0:D.course_id},null,8,["value"]),f(r(S),{type:"hidden",name:"rubric_id",value:($=r(o))==null?void 0:$.rubric_id},null,8,["value"]),f(r(S),{type:"hidden",name:"data[Evaluation][evaluator_id]",value:(y=r(o))==null?void 0:y.user_id},null,8,["value"]),f(r(S),{type:"hidden",name:"evaluateeCount",value:(P=r(o))==null?void 0:P.evaluatee_count},null,8,["value"]),(s(!0),d(R,null,E((k=r(o))==null?void 0:k.member_ids,(V,H)=>(s(),M(r(S),{type:"hidden",key:H,name:"memberIDs[]",value:V},null,8,["value"]))),128))]}),Q(e.$slots,"main",{},()=>{var C,I,q,D,$,y,P;return[(s(!0),d(R,null,E((q=(I=(C=r(l))==null?void 0:C.rubric)==null?void 0:I.data)==null?void 0:q.rubrics_criteria,(k,V)=>{var H,z,O,J;return s(),d("div",{class:"datatable",key:k.id},[k.criteria?(s(),d("div",Re,w(k.id)+". "+w(k.criteria),1)):U("",!0),Ee,f(fe,{members:r(b),"initial-state":n.value,rubric_criteria:k,rubrics_lom:(O=(z=(H=r(l))==null?void 0:H.rubric)==null?void 0:z.data)==null?void 0:O.rubrics_lom,disabled:a.isDisabled,autosave:N,"onUpdate:initialState":u},null,8,["members","initial-state","rubric_criteria","rubrics_lom","disabled","autosave"]),ae(f(ke,{members:r(b),"initial-state":n.value,rubric_criteria_idx:V,rubric_criteria:k,disabled:a.isDisabled,autosave:N,"onUpdate:initialState":u},null,8,["members","initial-state","rubric_criteria_idx","rubric_criteria","disabled","autosave"]),[[le,parseInt((J=r(l))==null?void 0:J.com_req)]])])}),128)),f(Be,{index:((P=(y=($=(D=r(l))==null?void 0:D.rubric)==null?void 0:$.data)==null?void 0:y.rubrics_criteria)==null?void 0:P.length)+1,members:r(b),"initial-state":n.value,rubric_criteria_idx:e.criteriaIdx,disabled:a.isDisabled,"onUpdate:initialState":u},null,8,["index","members","initial-state","rubric_criteria_idx","disabled"])]}),Q(e.$slots,"footer"),Q(e.$slots,"cta",{onSave:_,isSubmitting:g,values:p})]),_:3},8,["onSubmit","initial-state","evaluation"]))}});export{Ne as default};
