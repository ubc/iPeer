import{d as N,o as n,c as u,a,t as w,f as M,F as E,e as P,n as ie,p as H,q as b,u as d,v as h,L as F,j as G,r as Z,O as ae,y as Y,k as L,$ as le,w as ne,g as T,a0 as re,a1 as se}from"./main.50a5d5e8.js";import"./autosize.esm.7505a07e.js";import{_ as S,a as ue}from"./EvaluationForm.vue_vue_type_script_setup_true_lang.0a422faf.js";import{f as oe,e as ee}from"./rules.da5a5057.js";import{_ as de}from"./CustomRadioField.vue_vue_type_script_setup_true_lang.531a7b94.js";import{_ as O}from"./UserCard.vue_vue_type_script_setup_true_lang.aefe23fe.js";import{_ as te}from"./CustomTextField.vue_vue_type_script_setup_true_lang.c7545f12.js";const ce={class:"standardtable leftalignedtable"},me={style:{width:"20%"}},_e={class:"text-center leading-4"},ve={class:"text-sm font-normal leading-4 mb-1"},be={key:0,class:"text-sm font-thin"},fe={class:"text-center leading-4"},pe={class:"font-normal"},he={class:"text-sm font-thin"},xe=N({__name:"PeerRubricLikertQuestion",props:{members:null,initialState:null,rubric_criteria:null,rubrics_lom:null,disabled:{type:Boolean}},emits:["update:initialState"],setup(c,{emit:Q}){const i=c;function $(o,l,_){const s=h.exports.find(i.initialState.data,{evaluatee:l});return s?h.exports.filter(s==null?void 0:s.details,t=>{if(t.criteria_number===_)return t})[0]:""}function r(o){if(!i.disabled){const l=document.forms[0],_=`selected_lom_${o.key}_${o.target}`;l.querySelector(`input[name=${_}]`).setAttribute("value",o.value)}}return(o,l)=>{var _,s,e;return n(),u("table",ce,[a("thead",null,[a("tr",null,[a("th",me,[a("div",_e,[a("div",ve,w((_=i.rubric_criteria)==null?void 0:_.criteria),1),parseInt((s=i.rubric_criteria)==null?void 0:s.show_marks)?(n(),u("div",be,"("+w((e=i.rubric_criteria)==null?void 0:e.multiplier)+" marks)",1)):M("",!0)])]),(n(!0),u(E,null,P(i.rubrics_lom,(t,m)=>{var v,f;return n(),u("th",{style:ie("width: "+80/((v=i.rubrics_lom)==null?void 0:v.length)+"%"),key:t.id},[a("div",fe,[a("div",pe,w(t.lom_comment),1),a("div",he,w((f=i.rubric_criteria)==null?void 0:f.rubrics_criteria_comment[m].criteria_comment),1)])],4)}),128))])]),a("tbody",null,[(n(!0),u(E,null,P(i.members,(t,m)=>{var v,f,y,p;return n(),u(E,{key:t.id},[c.disabled?M("",!0):(n(),H(S,{key:0,name:`selected_lom_${t.id}_${(v=c.rubric_criteria)==null?void 0:v.id}`,value:(p=(y=$("criteria_num",t.id,(f=c.rubric_criteria)==null?void 0:f.criteria_num))==null?void 0:y.selected_lom)!=null?p:""},null,8,["name","value"])),a("tr",null,[a("td",null,[b(O,{member:t},null,8,["member"])]),(n(!0),u(E,null,P(i.rubrics_lom,(g,V)=>{var C,I,q,B;return n(),u("td",{key:g.id},[b(de,{ref_for:!0,ref:"selected_lom",member_id:t.id,criteria_num:(C=i.rubric_criteria)==null?void 0:C.criteria_num,name:`${t.id}criteria_points_${(I=c.rubric_criteria)==null?void 0:I.id}`,value:g.lom_num,rules:d(oe),checked:(B=$("criteria_num",t.id,(q=c.rubric_criteria)==null?void 0:q.criteria_num))==null?void 0:B.selected_lom,disabled:i.disabled,onClick:k=>{var x;return r({target:(x=c.rubric_criteria)==null?void 0:x.id,key:t.id,value:k.target.value})},onInput:k=>{var x;return o.$emit("update:initialState",{member_id:t.id,criteria_num:(x=c.rubric_criteria)==null?void 0:x.criteria_num,event:{key:"selected_lom",value:k.target.value}})}},null,8,["member_id","criteria_num","name","value","rules","checked","disabled","onClick","onInput"])])}),128))])],64)}),128))])])}}}),ye={class:"standardtable leftalignedtable"},ge=a("thead",null,[a("tr",null,[a("th",{style:{width:"20%"}},[a("div",{class:"flex flex-col text-center"},[a("div",{class:"leading-4 flex-1 font-medium"},"Peer"),a("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),a("th",{style:{width:"80%"}},[a("div",{class:"flex flex-col text-center"},[a("div",{class:"flex-1 font-medium"},"Comments"),a("small",{class:"flex-1 text-sm font-normal"})])])])],-1),$e={style:{width:"20%"}},ke={style:{width:"80%"}},Se={class:"flex flex-col"},we=["innerHTML"],Ce=N({__name:"PeerRubricCommentQuestion",props:{members:null,initialState:null,rubric_criteria_idx:null,rubric_criteria:null,disabled:{type:Boolean}},emits:["update:initialState"],setup(c,{emit:Q}){const i=c;F();function $(r,o,l){const _=h.exports.find(i.initialState.data,{evaluatee:o});return _?h.exports.filter(_==null?void 0:_.details,e=>{if(e.criteria_number===l)return e})[0]:""}return(r,o)=>(n(),u("table",ye,[ge,a("tbody",null,[(n(!0),u(E,null,P(i.members,(l,_)=>{var s,e,t;return n(),u("tr",{key:l.id},[a("td",$e,[b(O,{member:l},null,8,["member"])]),a("td",ke,[a("div",Se,[i.disabled?(n(),u("div",{key:0,class:"quotes text-sm text-slate-700 font-light tracking-wider",innerHTML:$("criteria_comment",l.id,(s=c.rubric_criteria)==null?void 0:s.criteria_num).criteria_comment},null,8,we)):(n(),H(te,{key:1,id:`${l.id}comments[${(e=c.rubric_criteria)==null?void 0:e.id}]`,name:`${l.id}comments[${i.rubric_criteria_idx}]`,value:$("criteria_comment",l.id,(t=c.rubric_criteria)==null?void 0:t.criteria_num).criteria_comment,rules:d(ee),disabled:i.disabled,onInput:m=>{var v;return r.$emit("update:initialState",{member_id:l.id,criteria_num:(v=c.rubric_criteria)==null?void 0:v.criteria_num,event:{key:"criteria_comment",value:m.target.value}})}},null,8,["id","name","value","rules","disabled","onInput"]))])])])}),128))])]))}}),Ie={class:"datatable"},qe={key:0,class:"question text-base text-slate-900 tracking-wide"},Be={key:1,class:"description text-sm text-slate-700 ml-5 mb-2 tracking-wider"},Re={class:"standardtable leftalignedtable"},Le=a("thead",null,[a("tr",null,[a("th",{style:{width:"20%"}},[a("div",{class:"flex flex-col text-center"},[a("div",{class:"leading-4 flex-1 font-medium"},"Peer"),a("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),a("th",{style:{width:"80%"}},[a("div",{class:"flex flex-col text-center"},[a("div",{class:"flex-1 font-medium"},"General Comments"),a("small",{class:"flex-1 text-sm font-normal"})])])])],-1),Ee=["innerHTML"],Pe=N({__name:"PeerRubricGeneralCommentQuestion",props:{index:null,members:null,initialState:null,disabled:{type:Boolean}},emits:["update:initialState"],setup(c,{emit:Q}){const i=c,$=F();G($.name==="submission.view");const r=Z({question:{title:"Please provide overall comments about each peer.",description:""}});function o(l,_){const s=i.initialState;if(s){const e=h.exports.find(s==null?void 0:s.data,{evaluatee:_});if(e)return e[l]}}return(l,_)=>{var s,e;return n(),u("div",Ie,[(s=r==null?void 0:r.question)!=null&&s.title?(n(),u("div",qe,w(i.index)+". "+w(r.question.title),1)):M("",!0),(e=r==null?void 0:r.question)!=null&&e.description?(n(),u("div",Be,w(r.question.description),1)):M("",!0),a("table",Re,[Le,a("tbody",null,[(n(!0),u(E,null,P(i.members,(t,m)=>(n(),u("tr",{key:t.id},[a("td",null,[b(O,{member:t},null,8,["member"])]),a("td",null,[i.disabled?(n(),u("div",{key:0,class:"quotes text-sm text-slate-700 font-light tracking-wider",innerHTML:o("comment",t.id)},null,8,Ee)):(n(),H(te,{key:1,name:`${t.id}gen_comment`,value:o("comment",t.id),rules:d(ee),disabled:i.disabled,onInput:v=>l.$emit("update:initialState",{member_id:t.id,criteria_num:"",event:{key:"comment",value:v.target.value}})},null,8,["name","value","rules","disabled","onInput"]))])]))),128))])])])}}}),Ue={key:0,class:"question"},De=a("div",{class:"description text-sm text-slate-700 mx-4 mb-2"},null,-1),je=N({__name:"RubricEvaluation",props:{members:null,currentUser:null,evaluation:null,disabled:{type:Boolean}},emits:["fetch:evaluation"],setup(c,{emit:Q}){const i=c,$=F();ae(),G($.name==="submission.view"),G(null),Y(i,"members");const r=Y(i,"evaluation");let o=Z({event_id:L(()=>{var e;return(e=r.value)==null?void 0:e.id}),group_id:L(()=>{var e,t;return(t=(e=r.value)==null?void 0:e.group)==null?void 0:t.id}),course_id:L(()=>{var e,t;return(t=(e=r.value)==null?void 0:e.course)==null?void 0:t.id}),group_event_id:L(()=>{var e;return(e=r.value)==null?void 0:e.group_event_id}),rubric_id:L(()=>{var e;return(e=r.value)==null?void 0:e.rubric_id}),user_id:L(()=>{var e;return(e=i.currentUser)==null?void 0:e.id}),evaluatee_count:L(()=>{var e,t;return(t=(e=r.value)==null?void 0:e.members)==null?void 0:t.length}),member_ids:L(()=>{var e;return h.exports.map((e=r.value)==null?void 0:e.members,t=>t.id)})});const l=G({});function _(){var e,t;return{id:"",submitter_id:(e=i.currentUser)==null?void 0:e.id,submitted:null,date_submitted:"",data:h.exports.map((t=i.evaluation)==null?void 0:t.members,m=>{var v,f,y,p;return{evaluator:(v=i.currentUser)==null?void 0:v.id,evaluatee:m==null?void 0:m.id,comment:"",score:"",details:h.exports.map((p=(y=(f=r.value)==null?void 0:f.rubric)==null?void 0:y.data)==null?void 0:p.rubrics_criteria,g=>({criteria_number:g==null?void 0:g.criteria_num,criteria_comment:"",selected_lom:""}))}})}}function s(e){var m,v,f,y;const t=h.exports.isEmpty(l.value)?{}:(m=l.value)==null?void 0:m.data;if(t){const p=h.exports.find(t,{evaluatee:e==null?void 0:e.member_id});if(p)if(((v=e==null?void 0:e.event)==null?void 0:v.key)==="comment")p.comment=(f=e==null?void 0:e.event)==null?void 0:f.value;else{const g=h.exports.find(p==null?void 0:p.details,{criteria_number:e.criteria_num});g&&(g[e.event.key]=(y=e.event)==null?void 0:y.value)}}}return le(()=>{var t,m;const e=_();((t=r.value)==null?void 0:t.response)&&!h.exports.isEmpty(r.value.response)?l.value=Object.assign(e,d((m=r.value)==null?void 0:m.response)):l.value=e}),(e,t)=>(n(),H(ue,{onSubmit:e.onSubmit,"initial-state":l.value,evaluation:i.evaluation,"onSet:message":t[0]||(t[0]=m=>e.$emit("set:message",e.message))},{default:ne(({onSave:m,errors:v,values:f,isSubmitting:y,evaluationRef:p,message:g,autosave:V})=>[T(e.$slots,"header",{},()=>{var C,I,q,B,k,x,U,D;return[b(d(S),{type:"hidden",name:"event_id",value:(C=d(o))==null?void 0:C.event_id},null,8,["value"]),b(d(S),{type:"hidden",name:"group_id",value:(I=d(o))==null?void 0:I.group_id},null,8,["value"]),b(d(S),{type:"hidden",name:"group_event_id",value:(q=d(o))==null?void 0:q.group_event_id},null,8,["value"]),b(d(S),{type:"hidden",name:"course_id",value:(B=d(o))==null?void 0:B.course_id},null,8,["value"]),b(d(S),{type:"hidden",name:"rubric_id",value:(k=d(o))==null?void 0:k.rubric_id},null,8,["value"]),b(d(S),{type:"hidden",name:"data[Evaluation][evaluator_id]",value:(x=d(o))==null?void 0:x.user_id},null,8,["value"]),b(d(S),{type:"hidden",name:"evaluateeCount",value:(U=d(o))==null?void 0:U.evaluatee_count},null,8,["value"]),(n(!0),u(E,null,P((D=d(o))==null?void 0:D.member_ids,(R,j)=>(n(),H(d(S),{type:"hidden",key:j,name:"memberIDs[]",value:R},null,8,["value"]))),128))]}),T(e.$slots,"main",{},()=>{var C,I,q,B,k,x,U,D;return[(n(!0),u(E,null,P((q=(I=(C=i.evaluation)==null?void 0:C.rubric)==null?void 0:I.data)==null?void 0:q.rubrics_criteria,(R,j)=>{var z,A,J,K,W,X;return n(),u("div",{class:"datatable",key:R.id},[R.criteria?(n(),u("div",Ue,w(R.id)+". "+w(R.criteria),1)):M("",!0),De,b(xe,{members:(z=i.evaluation)==null?void 0:z.members,"initial-state":l.value,rubric_criteria:R,rubrics_lom:(K=(J=(A=i.evaluation)==null?void 0:A.rubric)==null?void 0:J.data)==null?void 0:K.rubrics_lom,disabled:i.disabled,autosave:V,"onUpdate:initialState":s},null,8,["members","initial-state","rubric_criteria","rubrics_lom","disabled","autosave"]),re(b(Ce,{members:(W=i.evaluation)==null?void 0:W.members,"initial-state":l.value,rubric_criteria_idx:j,rubric_criteria:R,disabled:i.disabled,autosave:V,"onUpdate:initialState":s},null,8,["members","initial-state","rubric_criteria_idx","rubric_criteria","disabled","autosave"]),[[se,parseInt((X=i.evaluation)==null?void 0:X.com_req)]])])}),128)),b(Pe,{index:((U=(x=(k=(B=i.evaluation)==null?void 0:B.rubric)==null?void 0:k.data)==null?void 0:x.rubrics_criteria)==null?void 0:U.length)+1,members:(D=i.evaluation)==null?void 0:D.members,"initial-state":l.value,rubric_criteria_idx:e.criteriaIdx,disabled:i.disabled,"onUpdate:initialState":s},null,8,["index","members","initial-state","rubric_criteria_idx","disabled"])]}),T(e.$slots,"footer"),T(e.$slots,"cta",{onSave:m,isSubmitting:y,values:f})]),_:3},8,["onSubmit","initial-state","evaluation"]))}});export{je as default};
