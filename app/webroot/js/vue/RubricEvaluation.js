import{d as Q,T as K,x as X,o as n,c as u,a as t,B as Y,q as a,C as Z,g as U,t as h,v as ee,_ as j,F as S,e as I,n as te,p as _,r as M,D as re,L as ie,j as ae,s as le,k as y,m as H,w as se,f as A,H as ne,I as ue}from"./main.js";import"./sweetalert.min.js";import{l as g}from"./lodash.js";import{E as oe}from"./EvaluationForm.js";import{v as de,a as O}from"./rules.js";import{U as V}from"./UserCard.js";import{I as k}from"./InputText.js";import"./InputText.vue_vue_type_style_index_0_scoped_360a2797_lang.js";import{T as J}from"./TextArea.js";import"./_commonjsHelpers.js";import"./Debugger.js";import"./array.js";const ce=["id","name","value","disabled","checked"],me=["for"],_e=Q({__name:"InputRadio",props:{label:{type:String,required:!0},name:{type:String,required:!0},value:{type:String,required:!0},rules:{type:String,required:!0},checked:{type:Boolean,required:!0},disabled:{type:Boolean,required:!1}},emits:["update:input"],setup(d,{emit:L}){const r=d,{name:s,value:v}=K(r),{checked:c,handleChange:o,errorMessage:e,handleBlur:i,meta:l}=X(s,r.rules,{type:"radio",checkedValue:r.value,validateOnValueUpdate:!0}),p={blur:o,change:o,input:m=>o(m,!!e.value)};return(m,f)=>(n(),u("div",{class:ee(["form-radio flex-col justify-center items-center text-xs text-pink-500",{"flex flex-row":r.label,"has-error":!!a(e),success:a(l).valid}])},[t("input",Y({type:"radio",id:a(s),class:["form-check-input",{"form-check-input-error":!!a(e)}]},Z(p,!0),{name:a(s),value:r.value,disabled:d.disabled,checked:d.checked,onInput:f[0]||(f[0]=x=>m.$emit("update:input",x)),onBlur:f[1]||(f[1]=(...x)=>a(i)&&a(i)(...x))}),null,16,ce),U('  @input="handleChange"  '),r.label?(n(),u("label",{key:0,class:"form-radio-label",for:a(s)},h(r.label),9,me)):U("v-if",!0)],2))}}),ve=j(_e,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/components/fields/InputRadio.vue"]]),pe={class:"standardtable leftalignedtable"},fe={style:{width:"20%"}},be={class:""},he={class:"text-sm leading-4 font-serif font-medium"},xe={key:0,class:"text-sm font-normal"},ye={class:"flex flex-col text-center"},ke={class:"flex-1 font-medium"},ge={class:"flex-1 text-sm font-normal"},$e=Q({__name:"PeerRubricLikertQuestion",props:{members:{type:Array,required:!0},initialState:{type:null,required:!0},rubric_criteria:{type:null,required:!0},rubrics_lom:{type:Array,required:!0}},setup(d,{emit:L}){const r=d;function s(c,o,e){const i=g.exports.find(r.initialState.data,{evaluatee:o});return i?g.exports.filter(i==null?void 0:i.details,p=>{if(p.criteria_number===e)return p})[0]:""}function v(c){const o=document.forms[0],e=`selected_lom_${c.key}_${c.target}`;o.querySelector(`input[name=${e}]`).setAttribute("value",c.value)}return(c,o)=>{var e,i;return n(),u("table",pe,[t("thead",null,[t("tr",null,[t("th",fe,[t("div",be,[t("div",he,h((e=r.rubric_criteria)==null?void 0:e.criteria),1),parseInt(r.rubric_criteria.show_marks)?(n(),u("small",xe,"("+h((i=r.rubric_criteria)==null?void 0:i.multiplier)+" marks)",1)):U("v-if",!0)])]),(n(!0),u(S,null,I(r.rubrics_lom,(l,p)=>{var m;return n(),u("th",{style:te("width: "+80/r.rubrics_lom.length+"%"),key:l.id},[t("div",ye,[t("div",ke,h(l.lom_comment),1),t("small",ge,h((m=r.rubric_criteria)==null?void 0:m.rubrics_criteria_comment[p].criteria_comment),1)])],4)}),128))])]),t("tbody",null,[(n(!0),u(S,null,I(r.members,(l,p)=>{var m,f,x;return n(),u(S,{key:l.id},[_(a(k),{type:"hidden",name:`selected_lom_${l.id}_${d.rubric_criteria.id}`,value:(x=(f=s("criteria_num",l.id,(m=d.rubric_criteria)==null?void 0:m.criteria_num))==null?void 0:f.selected_lom)!=null?x:""},null,8,["name","value"]),t("tr",null,[t("td",null,[_(V,{member:l},null,8,["member"])]),(n(!0),u(S,null,I(r.rubrics_lom,(b,P)=>{var $,q,w;return n(),u("td",{key:b.id},[_(a(ve),{class:"flex justify-center",ref_for:!0,ref:"selected_lom",member_id:l.id,criteria_num:($=r.rubric_criteria)==null?void 0:$.criteria_num,name:`${l.id}criteria_points_${d.rubric_criteria.id}`,value:b.lom_num,rules:a(de),checked:parseInt(b.lom_num)===parseInt((w=s("criteria_num",l.id,(q=d.rubric_criteria)==null?void 0:q.criteria_num))==null?void 0:w.selected_lom),onClick:R=>v({target:d.rubric_criteria.id,key:l.id,value:R.target.value})},null,8,["member_id","criteria_num","name","value","rules","checked","onClick"])])}),128))])],64)}),128))])])}}}),qe=j($e,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/questions/PeerRubricLikertQuestion.vue"]]),we={class:"standardtable leftalignedtable"},Ce=t("thead",null,[t("tr",null,[t("th",{style:{width:"20%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"leading-4 flex-1 font-medium"},"Peer"),t("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),t("th",{style:{width:"80%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"flex-1 font-medium"},"Comments"),t("small",{class:"flex-1 text-sm font-normal"})])])])],-1),Se={style:{width:"20%"}},Re={style:{width:"80%"}},Ie={class:"flex flex-col"},Pe=Q({__name:"PeerRubricCommentQuestion",props:{rubric_criteria_idx:{type:[String,Number],required:!0},members:{type:Array,required:!0},initialState:{type:null,required:!0},rubric_criteria:{type:null,required:!0}},setup(d,{emit:L}){const r=d;function s(v,c,o){const e=g.exports.find(r.initialState.data,{evaluatee:c});return e?g.exports.filter(e==null?void 0:e.details,l=>{if(l.criteria_number===o)return l})[0]:""}return(v,c)=>(n(),u("table",we,[Ce,t("tbody",null,[(n(!0),u(S,null,I(r.members,(o,e)=>{var i,l;return n(),u("tr",{key:o.id},[t("td",Se,[_(V,{member:o},null,8,["member"])]),t("td",Re,[t("div",Ie,[_(a(J),{class:"flex-1",id:`${o.id}comments[${(i=d.rubric_criteria)==null?void 0:i.id}]`,name:`${o.id}comments[${r.rubric_criteria_idx}]`,value:s("criteria_comment",o.id,(l=d.rubric_criteria)==null?void 0:l.criteria_num).criteria_comment,rules:a(O)},null,8,["id","name","value","rules"])])])])}),128))])]))}}),Ue=j(Pe,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/questions/PeerRubricCommentQuestion.vue"]]),Ee={class:"datatable"},Be={key:0,class:"question text-base text-slate-900 tracking-wide"},Qe={key:1,class:"description text-sm text-slate-700 ml-5 mb-2 tracking-wider"},je={class:"standardtable leftalignedtable"},Le=t("thead",null,[t("tr",null,[t("th",{style:{width:"20%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"leading-4 flex-1 font-medium"},"Peer"),t("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),t("th",{style:{width:"80%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"flex-1 font-medium"},"General Comments"),t("small",{class:"flex-1 text-sm font-normal"})])])])],-1),Ae={class:"flex flex-col"},De=Q({__name:"PeerRubricGeneralCommentQuestion",props:{index:{type:[String,Number],required:!0},members:{type:Array,required:!0},initialState:{type:null,required:!0}},setup(d,{emit:L}){const r=d,s=M({question:{title:"Please provide overall comments about each peer.",description:""}});function v(c,o){return g.exports.find(r.initialState.data,{evaluatee:o})[c]}return(c,o)=>{var e,i;return n(),u("div",Ee,[(e=s==null?void 0:s.question)!=null&&e.title?(n(),u("div",Be,h(r.index)+". "+h(s.question.title),1)):U("v-if",!0),(i=s==null?void 0:s.question)!=null&&i.description?(n(),u("div",Qe,h(s.question.description),1)):U("v-if",!0),t("table",je,[Le,t("tbody",null,[(n(!0),u(S,null,I(r.members,(l,p)=>(n(),u("tr",{key:l.id},[t("td",null,[_(V,{member:l},null,8,["member"])]),t("td",null,[t("div",Ae,[_(J,{class:"flex-1",name:`${l.id}gen_comment`,value:v("comment",l.id),rules:a(O)},null,8,["name","value","rules"])])])]))),128))])])])}}}),Ve=j(De,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/questions/PeerRubricGeneralCommentQuestion.vue"]]),Ge={key:0,class:"question"},Ne=t("div",{class:"description text-sm text-slate-700 mx-4 mb-2"},null,-1),Te=Q({__name:"RubricEvaluation",props:{currentUser:{type:null,required:!0},evaluation:{type:null,required:!0}},emits:["fetch:evaluation"],setup(d,{emit:L}){const r=d;re(),ie(),ae();const s=le(r,"evaluation");let v=M({event_id:y(()=>{var e;return(e=s.value)==null?void 0:e.id}),group_id:y(()=>{var e,i;return(i=(e=s.value)==null?void 0:e.group)==null?void 0:i.id}),course_id:y(()=>{var e,i;return(i=(e=s.value)==null?void 0:e.course)==null?void 0:i.id}),group_event_id:y(()=>{var e;return(e=s.value)==null?void 0:e.group_event_id}),rubric_id:y(()=>{var e;return(e=s.value)==null?void 0:e.rubric_id}),user_id:y(()=>{var e;return(e=r.currentUser)==null?void 0:e.id}),evaluatee_count:y(()=>{var e,i;return(i=(e=s.value)==null?void 0:e.members)==null?void 0:i.length}),member_ids:y(()=>{var e;return g.exports.map((e=s.value)==null?void 0:e.members,i=>i.id)})});const c=y(()=>{var e,i,l,p,m,f;return((i=(e=s.value)==null?void 0:e.review)==null?void 0:i.response)&&!g.exports.isEmpty((p=(l=s.value)==null?void 0:l.review)==null?void 0:p.response)?a((f=(m=s.value)==null?void 0:m.review)==null?void 0:f.response):{data:o()}});function o(){var e;return g.exports.map((e=r.evaluation)==null?void 0:e.members,(i,l)=>{var p,m,f;return{evaluator:r.currentUser.id,evaluatee:i.id,comment:"",score:"",details:g.exports.map((f=(m=(p=s.value)==null?void 0:p.review)==null?void 0:m.data)==null?void 0:f.rubrics_criteria,(x,b)=>({criteria_number:x.criteria_num,criteria_comment:"",selected_lom:""}))}})}return(e,i)=>(n(),H(oe,{onSubmit:e.onSubmit,"initial-state":a(c),evaluation:r.evaluation},{default:se(({onSave:l,errors:p,values:m,isSubmitting:f,evaluationRef:x})=>[A(e.$slots,"header",{},()=>{var b,P,$,q,w,R,E,B;return[_(a(k),{type:"hidden",name:"event_id",value:(b=a(v))==null?void 0:b.event_id},null,8,["value"]),_(a(k),{type:"hidden",name:"group_id",value:(P=a(v))==null?void 0:P.group_id},null,8,["value"]),_(a(k),{type:"hidden",name:"group_event_id",value:($=a(v))==null?void 0:$.group_event_id},null,8,["value"]),_(a(k),{type:"hidden",name:"course_id",value:(q=a(v))==null?void 0:q.course_id},null,8,["value"]),_(a(k),{type:"hidden",name:"rubric_id",value:(w=a(v))==null?void 0:w.rubric_id},null,8,["value"]),_(a(k),{type:"hidden",name:"data[Evaluation][evaluator_id]",value:(R=a(v))==null?void 0:R.user_id},null,8,["value"]),_(a(k),{type:"hidden",name:"evaluateeCount",value:(E=a(v))==null?void 0:E.evaluatee_count},null,8,["value"]),(n(!0),u(S,null,I((B=a(v))==null?void 0:B.member_ids,(C,D)=>(n(),H(a(k),{type:"hidden",key:D,name:"memberIDs[]",value:C},null,8,["value"]))),128))]}),A(e.$slots,"main",{},()=>{var b,P,$,q,w,R,E,B;return[(n(!0),u(S,null,I(($=(P=(b=r.evaluation)==null?void 0:b.review)==null?void 0:P.data)==null?void 0:$.rubrics_criteria,(C,D)=>{var G,N,T,W,F,z;return n(),u("div",{class:"datatable",key:C.id},[C.criteria?(n(),u("div",Ge,h(C.id)+". "+h(C.criteria),1)):U("v-if",!0),Ne,_(qe,{members:(G=r.evaluation)==null?void 0:G.members,"initial-state":a(c),rubric_criteria:C,rubrics_lom:(W=(T=(N=r.evaluation)==null?void 0:N.review)==null?void 0:T.data)==null?void 0:W.rubrics_lom},null,8,["members","initial-state","rubric_criteria","rubrics_lom"]),ne(_(Ue,{members:(F=r.evaluation)==null?void 0:F.members,"initial-state":a(c),rubric_criteria_idx:D,rubric_criteria:C},null,8,["members","initial-state","rubric_criteria_idx","rubric_criteria"]),[[ue,parseInt((z=r.evaluation)==null?void 0:z.com_req)]])])}),128)),_(Ve,{index:((E=(R=(w=(q=r.evaluation)==null?void 0:q.review)==null?void 0:w.data)==null?void 0:R.rubrics_criteria)==null?void 0:E.length)+1,members:(B=r.evaluation)==null?void 0:B.members,"initial-state":a(c),rubric_criteria_idx:e.criteriaIdx},null,8,["index","members","initial-state","rubric_criteria_idx"])]}),A(e.$slots,"footer"),A(e.$slots,"cta",{onSave:l,isSubmitting:f,values:m})]),_:3},8,["onSubmit","initial-state","evaluation"]))}}),tt=j(Te,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/templates/RubricEvaluation.vue"]]);export{tt as default};
//# sourceMappingURL=RubricEvaluation.js.map
