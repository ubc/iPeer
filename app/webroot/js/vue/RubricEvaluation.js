import{d as L,o as u,c,a as t,t as q,g as E,F as U,e as D,n as Z,p as m,q as o,_ as j,r as K,D as ee,H as te,j as z,s as O,k as I,L as ie,m as J,w as re,f as B,M as ae,N as le}from"./main.js";import{l as h}from"./lodash.js";import"./autosize.esm.js";import{C as $,E as ne}from"./EvaluationForm.js";import{v as se,a as X}from"./rules.js";import{C as ue}from"./CustomRadioField.js";import{U as N}from"./UserCard.js";import{C as Y}from"./CustomTextField.js";import"./_commonjsHelpers.js";import"./sweetalert.min.js";import"./index2.js";const oe={class:"standardtable leftalignedtable"},ce={style:{width:"20%"}},de={class:"text-center leading-4"},me={class:"text-sm font-normal leading-4 mb-1"},_e={key:0,class:"text-sm font-thin"},ve={class:"text-center leading-4"},pe={class:"font-normal"},be={class:"text-sm font-thin"},fe=L({__name:"PeerRubricLikertQuestion",props:{members:{type:Array,required:!0},initialState:{type:null,required:!0},rubric_criteria:{type:null,required:!0},rubrics_lom:{type:Array,required:!0}},emits:["update:initialState"],setup(_,{emit:A}){const r=_;function l(s,d,n){const e=h.exports.find(r.initialState.data,{evaluatee:d});return e?h.exports.filter(e==null?void 0:e.details,a=>{if(a.criteria_number===n)return a})[0]:""}function v(s){const d=document.forms[0],n=`selected_lom_${s.key}_${s.target}`;d.querySelector(`input[name=${n}]`).setAttribute("value",s.value)}return(s,d)=>{var n,e,i;return u(),c("table",oe,[t("thead",null,[t("tr",null,[t("th",ce,[t("div",de,[t("div",me,q((n=r.rubric_criteria)==null?void 0:n.criteria),1),parseInt((e=r.rubric_criteria)==null?void 0:e.show_marks)?(u(),c("div",_e,"("+q((i=r.rubric_criteria)==null?void 0:i.multiplier)+" marks)",1)):E("v-if",!0)])]),(u(!0),c(U,null,D(r.rubrics_lom,(a,p)=>{var f;return u(),c("th",{style:Z("width: "+80/r.rubrics_lom.length+"%"),key:a.id},[t("div",ve,[t("div",pe,q(a.lom_comment),1),t("div",be,q((f=r.rubric_criteria)==null?void 0:f.rubrics_criteria_comment[p].criteria_comment),1)])],4)}),128))])]),t("tbody",null,[(u(!0),c(U,null,D(r.members,(a,p)=>{var f,y,k,x;return u(),c(U,{key:a.id},[m($,{name:`selected_lom_${a.id}_${(f=_.rubric_criteria)==null?void 0:f.id}`,value:(x=(k=l("criteria_num",a.id,(y=_.rubric_criteria)==null?void 0:y.criteria_num))==null?void 0:k.selected_lom)!=null?x:""},null,8,["name","value"]),t("tr",null,[t("td",null,[m(N,{member:a},null,8,["member"])]),(u(!0),c(U,null,D(r.rubrics_lom,(S,Q)=>{var w,C,P,R;return u(),c("td",{key:S.id},[m(ue,{ref_for:!0,ref:"selected_lom",member_id:a.id,criteria_num:(w=r.rubric_criteria)==null?void 0:w.criteria_num,name:`${a.id}criteria_points_${(C=_.rubric_criteria)==null?void 0:C.id}`,value:S.lom_num,rules:o(se),checked:(R=l("criteria_num",a.id,(P=_.rubric_criteria)==null?void 0:P.criteria_num))==null?void 0:R.selected_lom,onClick:g=>{var b;return v({target:(b=_.rubric_criteria)==null?void 0:b.id,key:a.id,value:g.target.value})},onInput:g=>{var b;return s.$emit("update:initialState",{member_id:a.id,criteria_num:(b=_.rubric_criteria)==null?void 0:b.criteria_num,event:{key:"selected_lom",value:g.target.value}})}},null,8,["member_id","criteria_num","name","value","rules","checked","onClick","onInput"]),E(' TBD:: :rules="question.required ? validateLikert : null" ')])}),128))])],64)}),128))])])}}}),he=j(fe,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/questions/PeerRubricLikertQuestion.vue"]]),xe={class:"standardtable leftalignedtable"},ye=t("thead",null,[t("tr",null,[t("th",{style:{width:"20%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"leading-4 flex-1 font-medium"},"Peer"),t("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),t("th",{style:{width:"80%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"flex-1 font-medium"},"Comments"),t("small",{class:"flex-1 text-sm font-normal"})])])])],-1),ke={style:{width:"20%"}},ge={style:{width:"80%"}},$e={class:"flex flex-col"},qe=L({__name:"PeerRubricCommentQuestion",props:{members:{type:Array,required:!0},initialState:{type:null,required:!0},rubric_criteria_idx:{type:[String,Number],required:!0},rubric_criteria:{type:null,required:!0}},emits:["update:initialState"],setup(_,{emit:A}){const r=_;function l(v,s,d){const n=h.exports.find(r.initialState.data,{evaluatee:s});return n?h.exports.filter(n==null?void 0:n.details,i=>{if(i.criteria_number===d)return i})[0]:""}return(v,s)=>(u(),c("table",xe,[ye,t("tbody",null,[(u(!0),c(U,null,D(r.members,(d,n)=>{var e,i;return u(),c("tr",{key:d.id},[t("td",ke,[m(N,{member:d},null,8,["member"])]),t("td",ge,[t("div",$e,[m(Y,{id:`${d.id}comments[${(e=_.rubric_criteria)==null?void 0:e.id}]`,name:`${d.id}comments[${r.rubric_criteria_idx}]`,value:l("criteria_comment",d.id,(i=_.rubric_criteria)==null?void 0:i.criteria_num).criteria_comment,rules:o(X),onInput:a=>{var p;return v.$emit("update:initialState",{member_id:d.id,criteria_num:(p=_.rubric_criteria)==null?void 0:p.criteria_num,event:{key:"criteria_comment",value:a.target.value}})}},null,8,["id","name","value","rules","onInput"]),E(' TBD:: :rules="question.required ? validateParagraph : null" ')])])])}),128))])]))}}),Se=j(qe,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/questions/PeerRubricCommentQuestion.vue"]]),we={class:"datatable"},Ce={key:0,class:"question text-base text-slate-900 tracking-wide"},Pe={key:1,class:"description text-sm text-slate-700 ml-5 mb-2 tracking-wider"},Re={class:"standardtable leftalignedtable"},Ie=t("thead",null,[t("tr",null,[t("th",{style:{width:"20%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"leading-4 flex-1 font-medium"},"Peer"),t("small",{class:"text-sm leading-4 flex-1 font-normal"})])]),t("th",{style:{width:"80%"}},[t("div",{class:"flex flex-col text-center"},[t("div",{class:"flex-1 font-medium"},"General Comments"),t("small",{class:"flex-1 text-sm font-normal"})])])])],-1),Ue={class:"flex flex-col"},Ee=L({__name:"PeerRubricGeneralCommentQuestion",props:{index:{type:[String,Number],required:!0},members:{type:Array,required:!0},initialState:{type:null,required:!0}},emits:["update:initialState"],setup(_,{emit:A}){const r=_,l=K({question:{title:"Please provide overall comments about each peer.",description:""}});function v(s,d){const n=r.initialState;if(n){const e=h.exports.find(n==null?void 0:n.data,{evaluatee:d});if(e)return e[s]}}return(s,d)=>{var n,e;return u(),c("div",we,[(n=l==null?void 0:l.question)!=null&&n.title?(u(),c("div",Ce,q(r.index)+". "+q(l.question.title),1)):E("v-if",!0),(e=l==null?void 0:l.question)!=null&&e.description?(u(),c("div",Pe,q(l.question.description),1)):E("v-if",!0),t("table",Re,[Ie,t("tbody",null,[(u(!0),c(U,null,D(r.members,(i,a)=>(u(),c("tr",{key:i.id},[t("td",null,[m(N,{member:i},null,8,["member"])]),t("td",null,[t("div",Ue,[m(Y,{name:`${i.id}gen_comment`,value:v("comment",i.id),rules:o(X),onInput:p=>s.$emit("update:initialState",{member_id:i.id,criteria_num:"",event:{key:"comment",value:p.target.value}})},null,8,["name","value","rules","onInput"]),E(' TBD:: :rules="question.required ? validateParagraph : null" ')])])]))),128))])])])}}}),De=j(Ee,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/questions/PeerRubricGeneralCommentQuestion.vue"]]),Qe={key:0,class:"question"},Be=t("div",{class:"description text-sm text-slate-700 mx-4 mb-2"},null,-1),Le=L({__name:"RubricEvaluation",props:{members:{type:Array,required:!0},currentUser:{type:null,required:!0},evaluation:{type:null,required:!0}},emits:["fetch:evaluation"],setup(_,{emit:A}){const r=_;ee(),te(),z(null),O(r,"members");const l=O(r,"evaluation");let v=K({event_id:I(()=>{var e;return(e=l.value)==null?void 0:e.id}),group_id:I(()=>{var e,i;return(i=(e=l.value)==null?void 0:e.group)==null?void 0:i.id}),course_id:I(()=>{var e,i;return(i=(e=l.value)==null?void 0:e.course)==null?void 0:i.id}),group_event_id:I(()=>{var e;return(e=l.value)==null?void 0:e.group_event_id}),rubric_id:I(()=>{var e;return(e=l.value)==null?void 0:e.rubric_id}),user_id:I(()=>{var e;return(e=r.currentUser)==null?void 0:e.id}),evaluatee_count:I(()=>{var e,i;return(i=(e=l.value)==null?void 0:e.members)==null?void 0:i.length}),member_ids:I(()=>{var e;return h.exports.map((e=l.value)==null?void 0:e.members,i=>i.id)})});const s=z({});function d(){var e;return{id:"",submitter_id:r.currentUser.id,submitted:null,date_submitted:"",data:h.exports.map((e=r.evaluation)==null?void 0:e.members,i=>{var a,p,f;return{evaluator:r.currentUser.id,evaluatee:i.id,comment:"",score:"",details:h.exports.map((f=(p=(a=l.value)==null?void 0:a.review)==null?void 0:p.data)==null?void 0:f.rubrics_criteria,y=>({criteria_number:y.criteria_num,criteria_comment:"",selected_lom:""}))}})}}function n(e){var a,p,f,y;const i=h.exports.isEmpty(s.value)?{}:(a=s.value)==null?void 0:a.data;if(i){const k=h.exports.find(i,{evaluatee:e==null?void 0:e.member_id});if(k)if(((p=e==null?void 0:e.event)==null?void 0:p.key)==="comment")k.comment=(f=e==null?void 0:e.event)==null?void 0:f.value;else{const x=h.exports.find(k==null?void 0:k.details,{criteria_number:e.criteria_num});x&&(x[e.event.key]=(y=e.event)==null?void 0:y.value)}}}return ie(()=>{var e,i;((e=l.value)==null?void 0:e.response)&&!h.exports.isEmpty(l.value.response)?s.value=Object.assign(d(),o((i=l.value)==null?void 0:i.response)):s.value=d()}),(e,i)=>(u(),J(ne,{onSubmit:e.onSubmit,"initial-state":s.value,evaluation:r.evaluation},{default:re(({onSave:a,errors:p,values:f,isSubmitting:y,evaluationRef:k})=>[B(e.$slots,"header",{},()=>{var x,S,Q,w,C,P,R,g;return[m(o($),{type:"hidden",name:"event_id",value:(x=o(v))==null?void 0:x.event_id},null,8,["value"]),m(o($),{type:"hidden",name:"group_id",value:(S=o(v))==null?void 0:S.group_id},null,8,["value"]),m(o($),{type:"hidden",name:"group_event_id",value:(Q=o(v))==null?void 0:Q.group_event_id},null,8,["value"]),m(o($),{type:"hidden",name:"course_id",value:(w=o(v))==null?void 0:w.course_id},null,8,["value"]),m(o($),{type:"hidden",name:"rubric_id",value:(C=o(v))==null?void 0:C.rubric_id},null,8,["value"]),m(o($),{type:"hidden",name:"data[Evaluation][evaluator_id]",value:(P=o(v))==null?void 0:P.user_id},null,8,["value"]),m(o($),{type:"hidden",name:"evaluateeCount",value:(R=o(v))==null?void 0:R.evaluatee_count},null,8,["value"]),(u(!0),c(U,null,D((g=o(v))==null?void 0:g.member_ids,(b,F)=>(u(),J(o($),{type:"hidden",key:F,name:"memberIDs[]",value:b},null,8,["value"]))),128))]}),B(e.$slots,"main",{},()=>{var x,S,Q,w,C,P,R,g;return[(u(!0),c(U,null,D((Q=(S=(x=r.evaluation)==null?void 0:x.review)==null?void 0:S.data)==null?void 0:Q.rubrics_criteria,(b,F)=>{var G,T,W,V,H,M;return u(),c("div",{class:"datatable",key:b.id},[b.criteria?(u(),c("div",Qe,q(b.id)+". "+q(b.criteria),1)):E("v-if",!0),Be,m(he,{members:(G=r.evaluation)==null?void 0:G.members,"initial-state":s.value,rubric_criteria:b,rubrics_lom:(V=(W=(T=r.evaluation)==null?void 0:T.review)==null?void 0:W.data)==null?void 0:V.rubrics_lom,"onUpdate:initialState":n},null,8,["members","initial-state","rubric_criteria","rubrics_lom"]),ae(m(Se,{members:(H=r.evaluation)==null?void 0:H.members,"initial-state":s.value,rubric_criteria_idx:F,rubric_criteria:b,"onUpdate:initialState":n},null,8,["members","initial-state","rubric_criteria_idx","rubric_criteria"]),[[le,parseInt((M=r.evaluation)==null?void 0:M.com_req)]])])}),128)),m(De,{index:((R=(P=(C=(w=r.evaluation)==null?void 0:w.review)==null?void 0:C.data)==null?void 0:P.rubrics_criteria)==null?void 0:R.length)+1,members:(g=r.evaluation)==null?void 0:g.members,"initial-state":s.value,rubric_criteria_idx:e.criteriaIdx,"onUpdate:initialState":n},null,8,["index","members","initial-state","rubric_criteria_idx"])]}),B(e.$slots,"footer"),B(e.$slots,"cta",{onSave:a,isSubmitting:y,values:f})]),_:3},8,["onSubmit","initial-state","evaluation"]))}}),Oe=j(Le,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/templates/RubricEvaluation.vue"]]);export{Oe as default};
//# sourceMappingURL=RubricEvaluation.js.map
