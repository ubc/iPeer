import{d as F,s as J,x as E,o as m,c as v,q as c,j as x,a as d,t as p,N as H,O as L,g as w,P as M,Q as q,_ as Q,I as z,J as A,u as P,B as G,f as K,R as W,p as b,F as X}from"./main.js";import{l as C}from"./lodash.js";import{s as $}from"./sweetalert.min.js";const Y=["name","value","checked"],ve=F({__name:"CustomHiddenField",props:{name:null,value:null,modelValue:null},setup(a){const i=a,e=J(i,"name"),{checked:S,handleChange:f}=E(e,void 0,{type:"hidden",checkedValue:i.value});return(D,I)=>(m(),v("input",{type:"hidden",name:c(e),value:i.value,checked:c(S)},null,8,Y))}}),Z=a=>(M("data-v-deffe746"),a=a(),q(),a),ee={class:"debugger"},te={class:"flex justify-between items-center"},ae={class:"text-teal-600 font-medium"},oe=Z(()=>d("hr",null,null,-1)),se={class:"flex justify-evenly space-x-4"},ne={key:0,class:"debug code flex-1 break-normal break-words break-all overflow-x"},le={key:1,class:"debug code flex-1 break-normal break-words break-all overflow-x"},re={key:2,class:"debug code flex-1 break-normal break-words break-all overflow-x"},ie=F({__name:"Debugger",props:{title:null,state:null,form:null,data:null},setup(a){const i=x(!1);function e(){i.value=!i.value}return(S,f)=>(m(),v("div",ee,[d("div",te,[d("h3",ae,p(a.title),1),d("button",{onClick:e},p(i.value?"Hide":"Show"),1)]),oe,H(d("div",se,[a.state?(m(),v("pre",ne,[d("code",null,p(JSON.stringify(a.state,null,2)),1)])):w("",!0),a.form?(m(),v("pre",le,[d("code",null,p(JSON.stringify(a.form,null,2)),1)])):w("",!0),a.data?(m(),v("pre",re,[d("code",null,p(JSON.stringify(a.data,null,2)),1)])):w("",!0)],512),[[L,i.value]])]))}});const g=Q(ie,[["__scopeId","data-v-deffe746"]]),ue={key:1},pe=F({__name:"EvaluationForm",props:{evaluation:null,initialState:null},emits:["submit","save"],setup(a,{emit:i}){var T;const e=a,S=z(),{values:f,errors:D,meta:I,handleSubmit:O,isSubmitting:B}=A({initialValues:(T=e.initialState)==null?void 0:T.data}),U=x(!1),y=x(!1),h=x();function R({errors:u}){var o;const s=Object.keys(u)[0],t=document.getElementById(s);(o=t==null?void 0:t.focus)==null||o.call(t),t==null||t.scrollIntoView({behavior:"smooth"})}O(()=>{i("submit",f)},R);const N=O(async()=>{var o,r,n;const u=new FormData(h.value);u.append("_method","POST");const s=new URLSearchParams;for(const l of u)s.append(l[0],l[1]);const t=await P(`/evaluations/makeEvaluation/${(o=e.evaluation)==null?void 0:o.id}/${(n=(r=e.evaluation)==null?void 0:r.group)==null?void 0:n.id}`,{method:"POST",timeout:300,body:s});await $({text:t.message,icon:t.statusText}),t.status===200&&await S.push({name:"dashboard"})},R);async function j(){var u,s,t,o,r,n;console.log({event_id:(u=e.evaluation)==null?void 0:u.id}),console.log({group_id:(t=(s=e.evaluation)==null?void 0:s.group)==null?void 0:t.id});try{const l=new FormData(h.value);l.append("_method","PUT");const k=new URLSearchParams;for(const V of l)k.append(V[0],V[1]);const _=await P(`/evaluations/makeEvaluation/${(o=e.evaluation)==null?void 0:o.id}/${(n=(r=e.evaluation)==null?void 0:r.group)==null?void 0:n.id}`,{method:"POST",timeout:300,body:k});await $({text:_.message,icon:_.statusText})}catch{await $({text:"something went wrong...",icon:"error"})}}return G(()=>C.exports.cloneDeep(e.initialState),C.exports.debounce(async(u,s)=>{var t,o,r;try{const n=new FormData(h.value);n.append("_method","PUT");const l=new URLSearchParams;for(const _ of n)l.append(_[0],_[1]);const k=await P(`/evaluations/makeEvaluation/${(t=e.evaluation)==null?void 0:t.id}/${(r=(o=e.evaluation)==null?void 0:o.group)==null?void 0:r.id}`,{method:"POST",timeout:300,body:l});console.table(k.message,"auto-saved every 5000ms!")}catch(n){console.warn("auto-save error.",n.message)}},5e3),{deep:!0}),(u,s)=>{var t,o,r,n;return m(),v(X,null,[d("form",{novalidate:"",onSubmit:s[0]||(s[0]=W((...l)=>c(N)&&c(N)(...l),["prevent"])),id:"evaluation_form",class:"evaluation-form",ref_key:"evaluation_form",ref:h},[K(u.$slots,"default",{evaluationRef:h.value,onSave:j,isSubmitting:c(B),errors:c(D),values:c(f),formMeta:c(I)})],544),U.value?(m(),v("button",{key:0,class:"debugger button default",onClick:s[1]||(s[1]=l=>y.value=!y.value)},p(y.value?"Hide":"Show")+" Debugger",1)):w("",!0),y.value?(m(),v("div",ue,[b(g,{title:"Form Values/Errors",state:c(f),form:c(D)},null,8,["state","form"]),b(g,{title:"InitialState",state:e.initialState},null,8,["state"]),b(g,{title:"Evaluation",state:e.evaluation},null,8,["state"]),b(g,{title:"Simple/Rubric/Mixed",state:((t=e.evaluation)==null?void 0:t.simple)||((o=e.evaluation)==null?void 0:o.rubric)||((r=e.evaluation)==null?void 0:r.mixed)},null,8,["state"]),b(g,{title:"Response",state:(n=e.evaluation)==null?void 0:n.response},null,8,["state"])])):w("",!0)],64)}}});export{ve as _,pe as a};
//# sourceMappingURL=EvaluationForm.vue_vue_type_script_setup_true_lang.js.map
