import{d as F,L as P,N as k,j as x,u as h,o as D,c as R,a as T,f as $,q as s,R as B,p as N,F as O,_ as U}from"./main.js";import{s as l}from"./sweetalert.min.js";import"./lodash.js";import{D as V}from"./Debugger.js";const j=F({__name:"EvaluationForm",props:{initialState:{type:null,required:!0},evaluation:{type:null,required:!0}},emits:["submit","save"],setup(w,{emit:b}){var f;const r=w,S=P(),{values:m,errors:_,meta:q,handleSubmit:p,isSubmitting:g}=k({initialValues:(f=r.initialState)==null?void 0:f.data}),c=x();function v({errors:t}){var o;const e=Object.keys(t)[0],a=document.getElementById(e);(o=a==null?void 0:a.focus)==null||o.call(a),a==null||a.scrollIntoView({behavior:"smooth"})}p(()=>{b("submit",m)},v);const d=p(async()=>{var o,n,i;const t=new FormData(c.value);t.append("_method","POST");const e=new URLSearchParams;for(const u of t)e.append(u[0],u[1]);const a=await h(`/evaluations/makeEvaluation/${(o=r.evaluation)==null?void 0:o.id}/${(i=(n=r.evaluation)==null?void 0:n.group)==null?void 0:i.id}`,{method:"POST",timeout:300,body:e});await l({text:a.message,icon:a.statusText}),a.status===200&&await S.push({name:"dashboard"})},v);async function y(){var t,e,a;try{const o=new FormData(c.value);o.append("_method","PUT");const n=new URLSearchParams;for(const u of o)n.append(u[0],u[1]);const i=await h(`/evaluations/makeEvaluation/${(t=r.evaluation)==null?void 0:t.id}/${(a=(e=r.evaluation)==null?void 0:e.group)==null?void 0:a.id}`,{method:"POST",timeout:300,body:n});await l({text:i.message,icon:i.statusText})}catch{await l({text:"something went wrong...",icon:"error"})}}return(t,e)=>(D(),R(O,null,[T("form",{onSubmit:e[0]||(e[0]=B((...a)=>s(d)&&s(d)(...a),["prevent"])),ref_key:"evaluation_form",ref:c,id:"evaluation_form",class:"evaluation-form"},[$(t.$slots,"default",{evaluationRef:t.evaluationRef,onSave:y,isSubmitting:s(g),errors:s(_),values:s(m)})],544),N(V,{class:"text-sm",state:s(m)},null,8,["state"])],64))}}),M=U(j,[["__file","/Users/josephkh/Workspace/iPeer/app/webroot/vue-ts-ipeer/src/student/views/EvaluationForm.vue"]]);export{M as E};
//# sourceMappingURL=EvaluationForm.js.map
